<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta content="initial-scale=1" name="viewport" /><title>Padrino - Padrino Mailer</title><link href="../../../images/favicons/apple-touch-icon-57x57-75d6516e.png" rel="apple-touch-icon" sizes="57x57" /><link href="../../../images/favicons/apple-touch-icon-60x60-76221479.png" rel="apple-touch-icon" sizes="60x60" /><link href="../../../images/favicons/apple-touch-icon-72x72-7bd96522.png" rel="apple-touch-icon" sizes="72x72" /><link href="../../../images/favicons/apple-touch-icon-76x76-30739e4d.png" rel="apple-touch-icon" sizes="76x76" /><link href="../../../images/favicons/apple-touch-icon-114x114-1b1963ee.png" rel="apple-touch-icon" sizes="114x114" /><link href="../../../images/favicons/apple-touch-icon-144x144-b3992622.png" rel="apple-touch-icon" sizes="144x144" /><link href="../../../images/favicons/apple-touch-icon-152x152-48259d13.png" rel="apple-touch-icon" sizes="152x152" /><link href="../../../images/favicons/apple-touch-icon-180x180-b8e9ebf6.png" rel="apple-touch-icon" sizes="180x180" /><link href="../../../images/favicons/favicon-32x32-c7d41b6f.png" rel="icon" sizes="32x32" type="image/png" /><link href="../../../images/favicons/favicon-194x194-a2b53f7f.png" rel="icon" sizes="194x194" type="image/png" /><link href="../../../images/favicons/favicon-96x96-1f5cec29.png" rel="icon" sizes="96x96" type="image/png" /><link href="../../../images/favicons/android-chrome-192x192-a15741d5.png" rel="icon" sizes="192x192" type="image/png" /><link href="../../../images/favicons/favicon-16x16-609a9b93.png" rel="icon" sizes="16x16" type="image/png" /><link href="/images/favicons/manifest.json" rel="manifest" /><link color="#5bbad5" href="../../../images/favicons/safari-pinned-tab-a188e924.svg" rel="mask-icon" /><link href="../../../images/favicons/favicon.ico" rel="shortcut icon" /><meta content="#da532c" name="msapplication-TileColor" /><meta content="../../../images/favicons/mstile-144x144-c2018144.png" name="msapplication-TileImage" /><meta content="/images/favicons/browserconfig.xml" name="msapplication-config" /><meta content="#ffffff" name="theme-color" /><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" /><link href="../../../assets/stylesheets/all-072dd7ac.css" rel="stylesheet" /><script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script><script src="../../../assets/javascripts/all-956a861e.js"></script><link href="http://padrinorb.com/blog.rss" rel="alternate" title="Blog - Padrino Ruby Web Framework" type="application/rss+xml" /></head><body class="guides guides_features guides_features_padrino-mailer guides_features_padrino-mailer_index"><div class="grid"><header class="header"><h1 class="header__name"><a href="/" class="padrino-name">Padrino</a></h1><div class="header__navigation"><nav class="navigation"><a class="navigation__toggler" href="#" id="navigation__toggler"><span class="navigation__toggler__icon fa fa-navicon"></span></a><ul class="navigation__items" id="navigation__items"><li class="navigation__item"><a href="/" class="navigation__link">Overview</a></li><li class="navigation__item"><a href="/guides/" class="navigation__link--is-active">Guides</a></li><li class="navigation__item"><a href="/blog/" class="navigation__link">Blog</a></li><li class="navigation__item"><a href="http://www.rubydoc.info/github/padrino/padrino-framework" class="navigation__link">API</a></li><li class="navigation__item"><a href="/contribute/" class="navigation__link">Contribute</a></li><li class="navigation__item"><a href="https://github.com/padrino/padrino-framework" class="navigation__link"><span class="button--slim">GitHub</span></a></li></ul></nav></div></header><div class="page"><div class="page__sidebar"><div class="sidebar"><h4 class="sidebar__header--first">Guides</h4><h5 class="sidebar__header"><a href="/guides/introduction/overview/">Introduction</a></h5><ul class="sidebar__items"><li class="sidebar__item"><a href="/guides/introduction/overview/" class="sidebar__link">Overview</a></li><li class="sidebar__item"><a href="/guides/introduction/why-learn-padrino/" class="sidebar__link">Why Learn Padrino?</a></li><li class="sidebar__item"><a href="/guides/introduction/examples/" class="sidebar__link">Examples</a></li><li class="sidebar__item"><a href="/guides/introduction/the-bleeding-edge/" class="sidebar__link">The Bleeding Edge</a></li><li class="sidebar__item"><a href="/guides/introduction/press/" class="sidebar__link">Press</a></li></ul><h5 class="sidebar__header"><a href="/guides/getting-started/overview/">Getting Started</a></h5><ul class="sidebar__items"><li class="sidebar__item"><a href="/guides/getting-started/overview/" class="sidebar__link">Overview</a></li><li class="sidebar__item"><a href="/guides/getting-started/basic-projects/" class="sidebar__link">Basic Projects</a></li><li class="sidebar__item"><a href="/guides/getting-started/installation/" class="sidebar__link">Installation</a></li><li class="sidebar__item"><a href="/guides/getting-started/blog-tutorial/" class="sidebar__link">Blog Tutorial</a></li></ul><h5 class="sidebar__header"><a href="/guides/features/overview/">Features</a></h5><ul class="sidebar__items"><li class="sidebar__item"><a href="/guides/features/overview/" class="sidebar__link">Overview</a></li><li class="sidebar__item"><a href="/guides/features/padrino-admin/" class="sidebar__link">Padrino Admin</a></li><li class="sidebar__item"><a href="/guides/features/padrino-mailer/" class="sidebar__link--is-active">Padrino Mailer</a></li><li class="sidebar__item"><a href="/guides/features/padrino-cache/" class="sidebar__link">Padrino Cache</a></li><li class="sidebar__item"><a href="/guides/features/mounting-applications/" class="sidebar__link">Mounting Applications</a></li><li class="sidebar__item"><a href="/guides/features/development-commands/" class="sidebar__link">Development Commands</a></li><li class="sidebar__item"><a href="/guides/features/extensions/" class="sidebar__link">Extensions</a></li><li class="sidebar__item"><a href="/guides/features/localization/" class="sidebar__link">Localization</a></li><li class="sidebar__item"><a href="/guides/features/rake-tasks/" class="sidebar__link">Rake Tasks</a></li></ul><h5 class="sidebar__header"><a href="/guides/generators/overview/">Generators</a></h5><ul class="sidebar__items"><li class="sidebar__item"><a href="/guides/generators/overview/" class="sidebar__link">Overview</a></li><li class="sidebar__item"><a href="/guides/generators/projects/" class="sidebar__link">Projects</a></li><li class="sidebar__item"><a href="/guides/generators/plugins/" class="sidebar__link">Plugins</a></li><li class="sidebar__item"><a href="/guides/generators/controllers/" class="sidebar__link">Controllers</a></li><li class="sidebar__item"><a href="/guides/generators/models/" class="sidebar__link">Models</a></li><li class="sidebar__item"><a href="/guides/generators/migrations/" class="sidebar__link">Migrations</a></li><li class="sidebar__item"><a href="/guides/generators/mailers/" class="sidebar__link">Mailers</a></li><li class="sidebar__item"><a href="/guides/generators/sub-applications/" class="sidebar__link">Sub-Applications</a></li><li class="sidebar__item"><a href="/guides/generators/tiny-skeleton/" class="sidebar__link">Tiny Skeleton</a></li><li class="sidebar__item"><a href="/guides/generators/admin/" class="sidebar__link">Admin</a></li><li class="sidebar__item"><a href="/guides/generators/components/" class="sidebar__link">Components</a></li><li class="sidebar__item"><a href="/guides/generators/tasks/" class="sidebar__link">Tasks</a></li></ul><h5 class="sidebar__header"><a href="/guides/controllers/overview/">Controllers</a></h5><ul class="sidebar__items"><li class="sidebar__item"><a href="/guides/controllers/overview/" class="sidebar__link">Overview</a></li><li class="sidebar__item"><a href="/guides/controllers/routing/" class="sidebar__link">Routing</a></li><li class="sidebar__item"><a href="/guides/controllers/layouts/" class="sidebar__link">Layouts</a></li><li class="sidebar__item"><a href="/guides/controllers/provides-formats/" class="sidebar__link">Provides Format</a></li><li class="sidebar__item"><a href="/guides/controllers/params-whitelisting/" class="sidebar__link">Params Whitelisting</a></li><li class="sidebar__item"><a href="/guides/controllers/route-filters/" class="sidebar__link">Route Filters</a></li><li class="sidebar__item"><a href="/guides/controllers/prioritized-routes/" class="sidebar__link">Prioritized Routes</a></li><li class="sidebar__item"><a href="/guides/controllers/custom-conditions/" class="sidebar__link">Custom Conditions</a></li><li class="sidebar__item"><a href="/guides/controllers/parsing-params/" class="sidebar__link">Parsing Params</a></li><li class="sidebar__item"><a href="/guides/controllers/rendering/" class="sidebar__link">Rendering</a></li><li class="sidebar__item"><a href="/guides/controllers/sessions/" class="sidebar__link">Sessions</a></li></ul><h5 class="sidebar__header"><a href="/guides/application-helpers/overview/">Application Helpers</a></h5><ul class="sidebar__items"><li class="sidebar__item"><a href="/guides/application-helpers/overview/" class="sidebar__link">Overview</a></li><li class="sidebar__item"><a href="/guides/application-helpers/output-helpers/" class="sidebar__link">Output Helpers</a></li><li class="sidebar__item"><a href="/guides/application-helpers/tag-helpers/" class="sidebar__link">Tag Helpers</a></li><li class="sidebar__item"><a href="/guides/application-helpers/asset-helpers/" class="sidebar__link">Asset Helpers</a></li><li class="sidebar__item"><a href="/guides/application-helpers/form-helpers/" class="sidebar__link">Form Helpers</a></li><li class="sidebar__item"><a href="/guides/application-helpers/form-builders/" class="sidebar__link">Form Builders</a></li><li class="sidebar__item"><a href="/guides/application-helpers/standard-form-builder/" class="sidebar__link">Standard Form Builder</a></li><li class="sidebar__item"><a href="/guides/application-helpers/custom-form-builders/" class="sidebar__link">Custom Form Builders</a></li><li class="sidebar__item"><a href="/guides/application-helpers/nested-object-form-support/" class="sidebar__link">Nested Object Form Support</a></li><li class="sidebar__item"><a href="/guides/application-helpers/format-helpers/" class="sidebar__link">Format Helpers</a></li><li class="sidebar__item"><a href="/guides/application-helpers/render-helpers/" class="sidebar__link">Render Helpers</a></li><li class="sidebar__item"><a href="/guides/application-helpers/custom-helpers/" class="sidebar__link">Custom Helpers</a></li><li class="sidebar__item"><a href="/guides/application-helpers/ujs-helpers/" class="sidebar__link">Unobtrusive JavaScript Helpers</a></li></ul><h5 class="sidebar__header"><a href="/guides/adding-components/overview/">Adding Components</a></h5><ul class="sidebar__items"><li class="sidebar__item"><a href="/guides/adding-components/overview/" class="sidebar__link">Overview</a></li><li class="sidebar__item"><a href="/guides/adding-components/persistence-engine/" class="sidebar__link">Persistence Engine</a></li><li class="sidebar__item"><a href="/guides/adding-components/javascript-engine/" class="sidebar__link">JavaScript Engine</a></li><li class="sidebar__item"><a href="/guides/adding-components/testing-library/" class="sidebar__link">Testing Library</a></li><li class="sidebar__item"><a href="/guides/adding-components/rendering-engine/" class="sidebar__link">Rendering Engine</a></li><li class="sidebar__item"><a href="/guides/adding-components/mocking-library/" class="sidebar__link">Mocking Library</a></li><li class="sidebar__item"><a href="/guides/adding-components/stylesheet-engine/" class="sidebar__link">Stylesheet Engine</a></li><li class="sidebar__item"><a href="/guides/adding-components/locale-translations/" class="sidebar__link">Locale Translations</a></li></ul><h5 class="sidebar__header"><a href="/guides/advanced-usage/overview/">Advanced Usage</a></h5><ul class="sidebar__items"><li class="sidebar__item"><a href="/guides/advanced-usage/overview/" class="sidebar__link">Overview</a></li><li class="sidebar__item"><a href="/guides/advanced-usage/extending-padrino-projects/" class="sidebar__link">Extending Padrino Projects</a></li><li class="sidebar__item"><a href="/guides/advanced-usage/3rd-party-plugins/" class="sidebar__link">3rd Party Plugins</a></li><li class="sidebar__item"><a href="/guides/advanced-usage/asynchronous-concurrency-with-padrino/" class="sidebar__link">Asyncronous Concurrency</a></li><li class="sidebar__item"><a href="/guides/advanced-usage/grape-with-padrino/" class="sidebar__link">Grape with Padrino</a></li><li class="sidebar__item"><a href="/guides/advanced-usage/running-padrino-on-jruby/" class="sidebar__link">Running Padrino on JRuby</a></li><li class="sidebar__item"><a href="/guides/advanced-usage/standalone-usage-in-sinatra/" class="sidebar__link">Standalone Usage in Sinatra</a></li><li class="sidebar__item"><a href="/guides/advanced-usage/padrino-and-omniauth-overview/" class="sidebar__link">Padrino and OmniAuth Overview</a></li></ul></div></div><div class="page__content"><div class="content"><p class="content__chapter-title">Features</p><h1 id="padrino-mailer">Padrino Mailer</h1>
<p>This component creates an easy and intuitive interface for delivering email
within a Sinatra application. The <a href="http://github.com/mikel/mail" title="mail">mail</a>
library is utilized to do the bulk of the work. There is full support for
rendering email templates, using a html content type and for file attachments.
The Padrino Mailer uses a familiar Sinatra syntax similar to that of defining
routes for a controller.</p>

<hr>
<h2 id="configuration">Configuration</h2>
<p>Let&#39;s take a look at using the Mailer in an application. By default, the mailer
uses the <a href="https://en.wikipedia.org/wiki/Sendmail" title="built-in sendmail">built-in sendmail</a>
binary on the server. However,
<a href="http://www.rubydoc.info/gems/mail/file/README.md#Sending_an_email_" title="mail config">other methods are supported</a>.</p>

<p>For example, to use SMTP, add the following declaration to your application:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/app.rb</span>
<span class="n">set</span> <span class="ss">:delivery_method</span><span class="p">,</span> <span class="ss">:smtp</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="ss">:address</span>              <span class="o">=&gt;</span> <span class="s2">"smtp.gmail.com"</span><span class="p">,</span>
  <span class="ss">:port</span>                 <span class="o">=&gt;</span> <span class="mi">587</span><span class="p">,</span>
  <span class="ss">:user_name</span>            <span class="o">=&gt;</span> <span class="s1">'&lt;username&gt;@gmail.com'</span><span class="p">,</span>
  <span class="ss">:password</span>             <span class="o">=&gt;</span> <span class="s1">'&lt;password&gt;'</span><span class="p">,</span>
  <span class="ss">:authentication</span>       <span class="o">=&gt;</span> <span class="ss">:plain</span><span class="p">,</span>
  <span class="ss">:enable_starttls_auto</span> <span class="o">=&gt;</span> <span class="kp">true</span>
<span class="p">}</span>
</code></pre></div>
<p>Once those have been defined, the default will become SMTP delivery unless
overwritten in an individual mail definition.</p>

<p>You can also configure the mailer to not send emails during development or
testing. This can be done with:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/app.rb</span>
<span class="n">set</span> <span class="ss">:delivery_method</span><span class="p">,</span> <span class="ss">:test</span>
</code></pre></div>
<p>When set, messages are added to the test mailer and can be retrieved with:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="no">Mail</span><span class="o">::</span><span class="no">TestMailer</span><span class="p">.</span><span class="nf">deliveries</span>
</code></pre></div>
<hr>
<h2 id="quick-usage">Quick Usage</h2>
<p>Padrino supports sending any arbitrary email (using either sendmail or SMTP)
right from your controllers. This is ideal for &#39;one-off&#39; emails where the &#39;full&#39;
mailer object is simply unnecessary or too heavy for your simple task.</p>

<p>Delivering an email within your controller is simple:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/controllers/session.rb</span>
<span class="n">post</span> <span class="ss">:create</span> <span class="k">do</span>
  <span class="n">email</span><span class="p">(</span><span class="ss">:from</span> <span class="o">=&gt;</span> <span class="s2">"tony@reyes.com"</span><span class="p">,</span>
    <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">"john@smith.com"</span><span class="p">,</span>
    <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">"Welcome!"</span><span class="p">,</span>
    <span class="ss">:body</span><span class="o">=&gt;</span><span class="s2">"Body"</span>
  <span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<p>This simple helper will accept any of the standard email attributes and deliver
your email in a single command. You can also use a block, render a template for
the body and specify a delivery method:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/controllers/session.rb</span>
<span class="n">post</span> <span class="ss">:create</span> <span class="k">do</span>
  <span class="n">email</span> <span class="k">do</span>
    <span class="n">from</span> <span class="s2">"tony@reyes.com"</span>
    <span class="n">to</span> <span class="s2">"john@smith.com"</span>
    <span class="n">subject</span> <span class="s2">"Welcome!"</span>
    <span class="n">body</span> <span class="n">render</span><span class="p">(</span><span class="s1">'email/registered'</span><span class="p">)</span>
    <span class="n">via</span> <span class="ss">:sendmail</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>This is all you need to send simple emails. However, Padrino also supports a
more &#39;structured&#39; mailer system as well.</p>

<hr>
<h2 id="mailer-usage">Mailer Usage</h2>
<p>To use the structured mailer syntax, we should define a custom mailer using the
<code>mailer</code> block:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/mailers/sample_mailer.rb</span>
<span class="no">MyAppName</span><span class="p">.</span><span class="nf">mailer</span> <span class="ss">:sample</span> <span class="k">do</span>
  <span class="n">email</span> <span class="ss">:registration_email</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">email</span><span class="o">|</span>
    <span class="n">from</span> <span class="s1">'admin@site.com'</span>
    <span class="n">to</span> <span class="n">email</span>
    <span class="n">subject</span> <span class="s1">'Welcome to the site!'</span>
    <span class="n">locals</span> <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="nb">name</span><span class="p">,</span> <span class="ss">:email</span> <span class="o">=&gt;</span> <span class="n">email</span>
    <span class="n">render</span> <span class="s1">'sample/registration_email'</span>
    <span class="n">content_type</span> <span class="ss">:html</span> <span class="c1"># optional, defaults to :plain</span>
    <span class="n">via</span> <span class="ss">:sendmail</span><span class="p">,</span> <span class="ss">:location</span> <span class="o">=&gt;</span> <span class="s2">"/usr/bin/sendmail"</span>  <span class="c1"># optional, to smtp if defined otherwise sendmail</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Note that this can be created much easier by using the padrino-mailer generator
in the terminal:</p>
<div class="highlight"><pre class="syntax shell"><code><span class="nv">$ </span>padrino g mailer Sample registration_email
</code></pre></div>
<p>This mailer defines a mail route called <code>registration_mail</code> within the <code>sample</code>
mailer. The <code>registration_email</code> route accepts the name and email arguments.
Arguments are passed to the email body template via the <code>locals</code> method. The
render command renders the email body template with the local variables, which
should be defined in <code>[views_path]/mailers/sample/registration_email.erb</code> as
shown below:</p>
<div class="highlight"><pre class="syntax erb"><code># ./views/mailers/sample/registration_email.erb
This is the body of the email and can access the <span class="cp">&lt;%=</span> <span class="nb">name</span> <span class="cp">%&gt;</span> variable.
That‘s all there is to defining the body of the email which can be in plain text
or html.
</code></pre></div>
<p>Note that the mailer has full support for content type resolution and the email
could also be in the path <code>./views/mailers/sample/registration_email.html.erb</code>
or <code>./views/mailers/sample/registration_email.plain.erb</code> specifying the mime
type in the file name as well.</p>

<p>Once the mailer has been defined and the template written, the email route can
be invoked by the <code>deliver</code> method:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="n">deliver</span><span class="p">(</span><span class="ss">:sample</span><span class="p">,</span> <span class="ss">:registration_email</span><span class="p">,</span> <span class="s2">"Bob"</span><span class="p">,</span> <span class="s2">"bob@bobby.com"</span><span class="p">)</span>
</code></pre></div>
<p>And that will then deliver the email according the configured options.</p>

<hr>
<h2 id="multipart-emails">Multipart Emails</h2>
<p>The mailer supports <a href="https://en.wikipedia.org/wiki/MIME" title="multipart emails">multipart emails</a>
quite easily:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/mailers/sample_mailer.rb</span>
<span class="n">mailer</span> <span class="ss">:sample</span> <span class="k">do</span>
  <span class="n">email</span> <span class="ss">:email_with_parts</span> <span class="k">do</span>
    <span class="n">from</span> <span class="s1">'admin@site.com'</span>
    <span class="c1"># ...</span>
    <span class="n">text_part</span> <span class="p">{</span> <span class="n">render</span><span class="p">(</span><span class="s1">'path/to/basic.text'</span><span class="p">)</span>  <span class="p">}</span>
    <span class="n">html_part</span> <span class="n">render</span><span class="p">(</span><span class="s1">'path/to/basic.html'</span><span class="p">)</span> <span class="c1"># shorter part syntax</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>You can even specify multiple part types using the <code>provides</code> declaration:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/mailers/sample_mailer.rb</span>
<span class="n">mailer</span> <span class="ss">:sample</span> <span class="k">do</span>
  <span class="n">email</span> <span class="ss">:email_with_parts</span> <span class="k">do</span>
    <span class="n">from</span> <span class="s1">'admin@site.com'</span>
    <span class="c1"># ...</span>
    <span class="c1"># renders path/to/basic.html.erb and path/to/basic.plain.erb</span>
    <span class="n">provides</span> <span class="ss">:plain</span><span class="p">,</span> <span class="ss">:html</span>
    <span class="n">render</span> <span class="s1">'path/to/basic'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>These will deliver a multipart/alternative email with the appropriate plain text
and html sections.</p>

<hr>
<h2 id="file-attachments">File Attachments</h2>
<p>Using the mailer attaching files to a message is easy:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/mailers/sample_mailer.rb</span>
<span class="n">mailer</span> <span class="ss">:sample</span> <span class="k">do</span>
  <span class="n">email</span> <span class="ss">:email_with_files</span> <span class="k">do</span>
    <span class="n">from</span> <span class="s1">'admin@site.com'</span>
    <span class="c1"># ...</span>
    <span class="n">body</span> <span class="s2">"Here are your files!"</span>
    <span class="n">add_file</span> <span class="ss">:filename</span> <span class="o">=&gt;</span> <span class="s1">'somefile.png'</span><span class="p">,</span> <span class="ss">:content</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s1">'/somefile.png'</span><span class="p">)</span>
    <span class="n">add_file</span> <span class="s1">'/full/path/to/someotherfile.png'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>This will deliver your email with the appropriate body and the specified files
attached.</p>

<hr>
<h2 id="defaults">Defaults</h2>
<p>To define mailer defaults for a message, we can do so app-wide or within a
<code>mailer</code> block.</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/app.rb</span>
<span class="c1"># Application-wide mailer defaults</span>
<span class="n">set</span> <span class="ss">:mailer_defaults</span><span class="p">,</span> <span class="ss">:from</span> <span class="o">=&gt;</span> <span class="s1">'admin@padrinorb.com'</span>

<span class="c1"># app/mailers/sample_mailer.rb</span>
<span class="no">MyAppName</span><span class="p">.</span><span class="nf">mailers</span> <span class="ss">:sample</span> <span class="k">do</span>
  <span class="n">defaults</span> <span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="s1">'html'</span>
  <span class="n">email</span> <span class="ss">:registration</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">age</span><span class="o">|</span>
    <span class="c1"># Uses default 'content_type' and 'from' values but can also overwrite them</span>
    <span class="n">to</span>      <span class="s1">'user@domain.com'</span>
    <span class="n">subject</span> <span class="s1">'Welcome to the site!'</span>
    <span class="n">locals</span>  <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="nb">name</span>
    <span class="n">render</span>  <span class="s1">'sample/registration'</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Using defaults makes sending email even easier when certain attributes are
repeated between messages.</p>

<hr>
<h2 id="rendering-variations">Rendering Variations</h2>
<p>To render a short body inline:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/mailers/sample_mailer.rb</span>
<span class="n">mailer</span> <span class="ss">:sample</span> <span class="k">do</span>
  <span class="n">email</span> <span class="ss">:short_email</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">user</span><span class="o">|</span>
    <span class="c1"># ...</span>
    <span class="n">body</span> <span class="s2">"This is a short body defined right in the mailer itself"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>To render a different template:</p>
<div class="highlight"><pre class="syntax ruby"><code><span class="c1"># app/mailers/sample_mailer.rb</span>
<span class="n">mailer</span> <span class="ss">:sample</span> <span class="k">do</span>
  <span class="n">email</span> <span class="ss">:custom_email</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">user</span><span class="o">|</span>
    <span class="c1"># ...</span>
    <span class="n">render</span><span class="p">(</span><span class="s1">'path/to/template'</span><span class="p">)</span> <span class="c1"># relative to views_path/mailers</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div><p class="updated"> last updated: 2018-12-14</p><div id='disqus_thread'></div>
<script type='text/javascript'>
//<![CDATA[
                  var disqus_shortname = 'padrinorb';
          
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
//]]>
</script>
<noscript>Please enable JavaScript to view the <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a></noscript>
<a href='http://disqus.com' class='dsq-brlink'>comments powered by <span class='logo-disqus'>Disqus</span></a>
</div></div></div><hr /><footer class="footer"><p>Padrino is released under the MIT LICENSE<br/>
Hosting by <a href="https://pages.github.com" title="GitHub Pages">GitHub Pages</a><br/>
Logo design by <a href="https://www.unpolo.com/" title="unpolo">unpolo</a></p>
<script>anchors.add('').remove('.sidebar h4, .sidebar h5, .header h1');</script></footer></div></body></html>